(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63596,e=>{e.v({actions:"batch-module__XCvZ4W__actions",buttonOutline:"batch-module__XCvZ4W__buttonOutline",buttonPrimary:"batch-module__XCvZ4W__buttonPrimary",buttonSecondary:"batch-module__XCvZ4W__buttonSecondary",container:"batch-module__XCvZ4W__container",error:"batch-module__XCvZ4W__error",fileInput:"batch-module__XCvZ4W__fileInput",fileName:"batch-module__XCvZ4W__fileName",fileSize:"batch-module__XCvZ4W__fileSize",header:"batch-module__XCvZ4W__header",section:"batch-module__XCvZ4W__section",sectionHeader:"batch-module__XCvZ4W__sectionHeader",sectionTitle:"batch-module__XCvZ4W__sectionTitle",select:"batch-module__XCvZ4W__select",stepNumber:"batch-module__XCvZ4W__stepNumber",subtitle:"batch-module__XCvZ4W__subtitle",title:"batch-module__XCvZ4W__title",uploadArea:"batch-module__XCvZ4W__uploadArea",uploadIcon:"batch-module__XCvZ4W__uploadIcon",uploadLabel:"batch-module__XCvZ4W__uploadLabel"})},11031,e=>{e.v({actions:"ColumnMappingForm-module__Mt7egW__actions",buttonSmall:"ColumnMappingForm-module__Mt7egW__buttonSmall",clearButton:"ColumnMappingForm-module__Mt7egW__clearButton",compact:"ColumnMappingForm-module__Mt7egW__compact",container:"ColumnMappingForm-module__Mt7egW__container",defaultValue:"ColumnMappingForm-module__Mt7egW__defaultValue",fieldDescription:"ColumnMappingForm-module__Mt7egW__fieldDescription",fieldName:"ColumnMappingForm-module__Mt7egW__fieldName",helpText:"ColumnMappingForm-module__Mt7egW__helpText",sampleValue:"ColumnMappingForm-module__Mt7egW__sampleValue",select:"ColumnMappingForm-module__Mt7egW__select",summary:"ColumnMappingForm-module__Mt7egW__summary",summaryItem:"ColumnMappingForm-module__Mt7egW__summaryItem",table:"ColumnMappingForm-module__Mt7egW__table",tableBody:"ColumnMappingForm-module__Mt7egW__tableBody",tableCell:"ColumnMappingForm-module__Mt7egW__tableCell",tableHeader:"ColumnMappingForm-module__Mt7egW__tableHeader",tableHeaderCell:"ColumnMappingForm-module__Mt7egW__tableHeaderCell",tableRow:"ColumnMappingForm-module__Mt7egW__tableRow",tableRowMapped:"ColumnMappingForm-module__Mt7egW__tableRowMapped"})},7877,e=>{e.v({card:"PreviewGrid-module__L5-mUa__card",cardFooter:"PreviewGrid-module__L5-mUa__cardFooter",empty:"PreviewGrid-module__L5-mUa__empty",error:"PreviewGrid-module__L5-mUa__error",errorDetails:"PreviewGrid-module__L5-mUa__errorDetails",errorIcon:"PreviewGrid-module__L5-mUa__errorIcon",errorText:"PreviewGrid-module__L5-mUa__errorText",grid:"PreviewGrid-module__L5-mUa__grid",image:"PreviewGrid-module__L5-mUa__image",imageContainer:"PreviewGrid-module__L5-mUa__imageContainer",loading:"PreviewGrid-module__L5-mUa__loading",rowLabel:"PreviewGrid-module__L5-mUa__rowLabel"})},19667,e=>{e.v({actions:"BatchJobStatus-module__UNPJba__actions",container:"BatchJobStatus-module__UNPJba__container",downloadButton:"BatchJobStatus-module__UNPJba__downloadButton",error:"BatchJobStatus-module__UNPJba__error",manifestButton:"BatchJobStatus-module__UNPJba__manifestButton",progress:"BatchJobStatus-module__UNPJba__progress",progressBar:"BatchJobStatus-module__UNPJba__progressBar",progressFill:"BatchJobStatus-module__UNPJba__progressFill",progressText:"BatchJobStatus-module__UNPJba__progressText",spin:"BatchJobStatus-module__UNPJba__spin",statError:"BatchJobStatus-module__UNPJba__statError",statItem:"BatchJobStatus-module__UNPJba__statItem",statLabel:"BatchJobStatus-module__UNPJba__statLabel",statValue:"BatchJobStatus-module__UNPJba__statValue",stats:"BatchJobStatus-module__UNPJba__stats",statusBadge:"BatchJobStatus-module__UNPJba__statusBadge",statusDefault:"BatchJobStatus-module__UNPJba__statusDefault",statusError:"BatchJobStatus-module__UNPJba__statusError",statusIcon:"BatchJobStatus-module__UNPJba__statusIcon",statusProcessing:"BatchJobStatus-module__UNPJba__statusProcessing",statusSuccess:"BatchJobStatus-module__UNPJba__statusSuccess",statusText:"BatchJobStatus-module__UNPJba__statusText"})},44634,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(79275),l=e.i(63596),r=e.i(11031);let d=[{key:"headline",label:"Headline",description:"Main headline text",required:!1},{key:"subheadline",label:"Subheadline",description:"Secondary headline text",required:!1},{key:"body",label:"Body Text",description:"Main body content",required:!1},{key:"cta",label:"Call-to-Action",description:"CTA button text",required:!1},{key:"backgroundImage",label:"Background Image",description:"URL or path to background image",required:!1},{key:"productImage",label:"Product Image",description:"URL or path to product/feature image",required:!1},{key:"logo",label:"Logo",description:"URL or path to logo image",required:!1},{key:"backgroundColor",label:"Background Color",description:"Hex color code (e.g., #3b82f6)",required:!1},{key:"primaryColor",label:"Primary Color",description:"Hex color code for primary brand color",required:!1},{key:"uniqueId",label:"Unique ID",description:"Unique identifier (SKU, product ID, etc.)",required:!1}];function o({headers:e,sampleRows:s,template:l,columnMapping:o,onMappingUpdate:i,disabled:n=!1}){let[c,u]=(0,t.useState)(o),[m,_]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{i(c)},[c,i]),(0,a.jsxs)("div",{className:r.default.container,children:[(0,a.jsxs)("div",{className:r.default.actions,children:[(0,a.jsx)("button",{onClick:()=>{let a={};d.forEach(t=>{let s=e.find(e=>{let a=e.toLowerCase().replace(/[_\s-]/g,""),s=t.key.toLowerCase().replace(/[_\s-]/g,"");return a===s||a.includes(s)||s.includes(a)});s&&(a[t.key]=s)}),u(a)},className:r.default.buttonSmall,disabled:n,children:"Auto-detect"}),(0,a.jsx)("button",{onClick:()=>{u({})},className:r.default.buttonSmall,disabled:n,children:"Clear All"}),(0,a.jsxs)("button",{onClick:()=>_(!m),className:r.default.buttonSmall,children:[m?"Hide":"Show"," Samples"]})]}),(0,a.jsxs)("div",{className:r.default.table,children:[(0,a.jsxs)("div",{className:r.default.tableHeader,children:[(0,a.jsx)("div",{className:r.default.tableHeaderCell,children:"Template Field"}),(0,a.jsx)("div",{className:r.default.tableHeaderCell,children:"CSV Column"}),m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:r.default.tableHeaderCell,children:"Sample Value"}),(0,a.jsx)("div",{className:r.default.tableHeaderCell,children:"Current Default"})]}),(0,a.jsx)("div",{className:r.default.tableHeaderCell,children:"Actions"})]}),(0,a.jsx)("div",{className:r.default.tableBody,children:d.map(t=>{var d;let o=c[t.key],i=!!o;return(0,a.jsxs)("div",{className:`${r.default.tableRow} ${i?r.default.tableRowMapped:""}`,children:[(0,a.jsxs)("div",{className:r.default.tableCell,children:[(0,a.jsx)("div",{className:r.default.fieldName,children:t.label}),(0,a.jsx)("div",{className:r.default.fieldDescription,children:t.description})]}),(0,a.jsx)("div",{className:r.default.tableCell,children:(0,a.jsxs)("select",{value:o||"",onChange:e=>{var a,s;return a=t.key,s=e.target.value,void u(e=>({...e,[a]:s||void 0}))},className:r.default.select,disabled:n,children:[(0,a.jsx)("option",{value:"",children:"â€” Not mapped â€”"}),e.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:r.default.tableCell,children:(0,a.jsx)("div",{className:r.default.sampleValue,children:o&&0!==s.length&&s[0][o]||"â€”"})}),(0,a.jsx)("div",{className:r.default.tableCell,children:(0,a.jsx)("div",{className:r.default.defaultValue,children:"primaryColor"===(d=t.key)?l.style.primaryColor||"â€”":l.content[d]||"â€”"})})]}),(0,a.jsx)("div",{className:r.default.tableCell,children:i&&(0,a.jsx)("button",{onClick:()=>{var e;return e=t.key,void u(a=>{let t={...a};return delete t[e],t})},className:r.default.clearButton,disabled:n,title:"Clear mapping",children:"âœ•"})})]},t.key)})})]}),(0,a.jsxs)("div",{className:r.default.summary,children:[(0,a.jsxs)("div",{className:r.default.summaryItem,children:[(0,a.jsx)("strong",{children:"CSV Columns:"})," ",e.length]}),(0,a.jsxs)("div",{className:r.default.summaryItem,children:[(0,a.jsx)("strong",{children:"Mapped Fields:"})," ",Object.keys(c).length]}),(0,a.jsxs)("div",{className:r.default.summaryItem,children:[(0,a.jsx)("strong",{children:"Sample Rows:"})," ",s.length]})]}),(0,a.jsx)("div",{className:r.default.helpText,children:(0,a.jsxs)("p",{children:["ðŸ’¡ ",(0,a.jsx)("strong",{children:"Tip:"}),' Click "Auto-detect" to automatically match column names to template fields. Unmapped fields will use the template\'s default values.']})})]})}var i=e.i(7877);function n({jobId:e}){let[s,l]=(0,t.useState)([]),[r,d]=(0,t.useState)(!0);return((0,t.useEffect)(()=>{e?fetch(`/api/ads/batch/preview-assets/${e}`).then(e=>e.json()).then(e=>{l(e.assets||[]),d(!1)}).catch(e=>{console.error("Error loading preview assets:",e),d(!1)}):d(!1)},[e]),r)?(0,a.jsx)("div",{className:i.default.loading,children:"Loading previews..."}):0===s.length?(0,a.jsx)("div",{className:i.default.empty,children:"No preview assets available. Generate a preview to see results."}):(0,a.jsx)("div",{className:i.default.grid,children:s.map(t=>(0,a.jsx)("div",{className:i.default.card,children:"completed"===t.status?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:i.default.imageContainer,children:(0,a.jsx)("img",{src:`/api/ads/batch/asset/${e}/${t.filePath}`,alt:`Preview ${t.rowIndex}`,className:i.default.image})}),(0,a.jsx)("div",{className:i.default.cardFooter,children:(0,a.jsxs)("span",{className:i.default.rowLabel,children:["Row ",t.rowIndex]})})]}):(0,a.jsxs)("div",{className:i.default.error,children:[(0,a.jsx)("div",{className:i.default.errorIcon,children:"âœ•"}),(0,a.jsxs)("div",{className:i.default.errorText,children:["Failed to render row ",t.rowIndex]}),t.error&&(0,a.jsx)("div",{className:i.default.errorDetails,children:t.error})]})},t.id))})}var c=e.i(19667);function u({job:e}){return(0,a.jsxs)("div",{className:c.default.container,children:[(0,a.jsxs)("div",{className:`${c.default.statusBadge} ${(()=>{switch(e.status){case"completed":return c.default.statusSuccess;case"error":return c.default.statusError;case"rendering":return c.default.statusProcessing;default:return c.default.statusDefault}})()}`,children:[(0,a.jsx)("span",{className:c.default.statusIcon,children:(()=>{switch(e.status){case"completed":return"âœ“";case"error":return"âœ•";case"rendering":return"âŸ³";case"previewing":return"ðŸ‘";case"mapping":return"ðŸ—º";default:return"â—‹"}})()}),(0,a.jsx)("span",{className:c.default.statusText,children:(()=>{switch(e.status){case"mapping":return"Mapping columns...";case"previewing":return"Generating preview...";case"rendering":return"Rendering ads...";case"completed":return"Batch complete!";case"error":return"Error occurred";default:return"Ready"}})()})]}),"rendering"===e.status&&(0,a.jsxs)("div",{className:c.default.progress,children:[(0,a.jsx)("div",{className:c.default.progressBar,children:(0,a.jsx)("div",{className:c.default.progressFill,style:{width:`${e.progress}%`}})}),(0,a.jsxs)("div",{className:c.default.progressText,children:[e.progress,"% (",e.completedAssets," / ",e.totalAssets,")"]})]}),("completed"===e.status||"previewing"===e.status)&&(0,a.jsxs)("div",{className:c.default.stats,children:[(0,a.jsxs)("div",{className:c.default.statItem,children:[(0,a.jsx)("div",{className:c.default.statValue,children:e.totalAssets}),(0,a.jsx)("div",{className:c.default.statLabel,children:"Total Assets"})]}),(0,a.jsxs)("div",{className:c.default.statItem,children:[(0,a.jsx)("div",{className:c.default.statValue,children:e.completedAssets}),(0,a.jsx)("div",{className:c.default.statLabel,children:"Completed"})]}),e.failedAssets>0&&(0,a.jsxs)("div",{className:c.default.statItem,children:[(0,a.jsx)("div",{className:`${c.default.statValue} ${c.default.statError}`,children:e.failedAssets}),(0,a.jsx)("div",{className:c.default.statLabel,children:"Failed"})]})]}),e.error&&(0,a.jsxs)("div",{className:c.default.error,children:[(0,a.jsx)("strong",{children:"Error:"})," ",e.error]}),e.jobId&&"completed"===e.status&&(0,a.jsxs)("div",{className:c.default.actions,children:[(0,a.jsx)("a",{href:`/api/ads/batch/download/${e.jobId}`,className:c.default.downloadButton,download:!0,children:"ðŸ“¦ Download ZIP"}),(0,a.jsx)("a",{href:`/api/ads/batch/manifest/${e.jobId}`,className:c.default.manifestButton,target:"_blank",rel:"noopener noreferrer",children:"ðŸ“„ View Manifest"})]})]})}let m=["example-hero-ad","example-quote-ad","example-minimal-ad","example-text-only-ad"];function _(){let[e,r]=(0,t.useState)({file:null,headers:[],sampleRows:[],error:null}),[d,i]=(0,t.useState)("example-hero-ad"),[c,_]=(0,t.useState)(null),[p,h]=(0,t.useState)({}),[f,b]=(0,t.useState)({jobId:null,status:"idle",progress:0,totalAssets:0,completedAssets:0,failedAssets:0,error:null}),g=async e=>{try{let a=await fetch(`/data/ads/${e}.json`),t=await a.json();_(t)}catch(e){console.error("Error loading template:",e)}},v=(0,t.useCallback)(async e=>{let a=e.target.files?.[0];if(a)try{let e=(await a.text()).split("\n").filter(e=>e.trim());if(0===e.length)throw Error("CSV file is empty");let t=e[0].split(",").map(e=>e.trim().replace(/^"|"$/g,"")),s=e.slice(1,4).map(e=>{let a=e.split(",").map(e=>e.trim().replace(/^"|"$/g,"")),s={};return t.forEach((e,t)=>{s[e]=a[t]||""}),s});r({file:a,headers:t,sampleRows:s,error:null}),b(e=>({...e,status:"mapping"}))}catch(e){r({file:null,headers:[],sampleRows:[],error:e instanceof Error?e.message:"Failed to parse CSV"})}},[]);(0,t.useEffect)(()=>{(0,s.trackFeatureDiscovery)("csv_import")},[]);let x=async()=>{if(e.file&&c){b(e=>({...e,status:"previewing",progress:0}));try{let a=new FormData;a.append("csv",e.file),a.append("template",JSON.stringify(c)),a.append("columnMapping",JSON.stringify(p)),a.append("previewCount","3");let t=await fetch("/api/ads/batch/preview",{method:"POST",body:a});if(!t.ok)throw Error("Failed to generate preview");let s=await t.json();b(e=>({...e,status:"previewing",totalAssets:s.assets.length,completedAssets:s.assets.filter(e=>"completed"===e.status).length,failedAssets:s.assets.filter(e=>"failed"===e.status).length}))}catch(e){b(a=>({...a,status:"error",error:e instanceof Error?e.message:"Preview generation failed"}))}}},j=async()=>{if(e.file&&c){b(e=>({...e,status:"rendering",progress:0}));try{let a=new FormData;a.append("csv",e.file),a.append("template",JSON.stringify(c)),a.append("columnMapping",JSON.stringify(p)),a.append("format","png"),a.append("createZip","true");let t=await fetch("/api/ads/batch/render",{method:"POST",body:a});if(!t.ok)throw Error("Failed to start batch render");let s=await t.json();b(e=>({...e,jobId:s.jobId,status:"rendering",totalAssets:s.totalAssets})),N(s.jobId)}catch(e){b(a=>({...a,status:"error",error:e instanceof Error?e.message:"Batch render failed"}))}}},N=async e=>{let a=setInterval(async()=>{try{let t=await fetch(`/api/ads/batch/status/${e}`);if(!t.ok)throw Error("Failed to fetch job status");let s=await t.json();b(e=>({...e,status:"completed"===s.status?"completed":"rendering",progress:s.progress,completedAssets:s.completedCount,failedAssets:s.failedCount})),("completed"===s.status||"failed"===s.status)&&clearInterval(a)}catch(e){console.error("Error polling job status:",e),clearInterval(a)}},2e3)};return(0,a.jsxs)("div",{className:l.default.container,children:[(0,a.jsxs)("header",{className:l.default.header,children:[(0,a.jsx)("h1",{className:l.default.title,children:"Batch Ad Generator"}),(0,a.jsx)("p",{className:l.default.subtitle,children:"Upload CSV and generate hundreds of ad creatives"})]}),(0,a.jsxs)("section",{className:l.default.section,children:[(0,a.jsx)("div",{className:l.default.sectionHeader,children:(0,a.jsxs)("h2",{className:l.default.sectionTitle,children:[(0,a.jsx)("span",{className:l.default.stepNumber,children:"1"}),"Upload CSV File"]})}),(0,a.jsxs)("div",{className:l.default.uploadArea,children:[(0,a.jsx)("input",{type:"file",accept:".csv",onChange:v,className:l.default.fileInput,id:"csv-upload",disabled:"rendering"===f.status}),(0,a.jsx)("label",{htmlFor:"csv-upload",className:l.default.uploadLabel,children:e.file?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:l.default.fileName,children:e.file.name}),(0,a.jsxs)("span",{className:l.default.fileSize,children:["(",Math.round(e.file.size/1024)," KB)"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:l.default.uploadIcon,children:"ðŸ“"}),(0,a.jsx)("span",{children:"Choose CSV file or drag and drop"})]})}),e.error&&(0,a.jsx)("div",{className:l.default.error,children:e.error})]})]}),e.file&&(0,a.jsxs)("section",{className:l.default.section,children:[(0,a.jsx)("div",{className:l.default.sectionHeader,children:(0,a.jsxs)("h2",{className:l.default.sectionTitle,children:[(0,a.jsx)("span",{className:l.default.stepNumber,children:"2"}),"Select Template"]})}),(0,a.jsx)("select",{value:d,onChange:e=>{var a;i(a=e.target.value),g(a)},className:l.default.select,disabled:"rendering"===f.status,children:m.map(e=>(0,a.jsx)("option",{value:e,children:e.replace("example-","").replace(/-/g," ")},e))})]}),e.file&&c&&(0,a.jsxs)("section",{className:l.default.section,children:[(0,a.jsx)("div",{className:l.default.sectionHeader,children:(0,a.jsxs)("h2",{className:l.default.sectionTitle,children:[(0,a.jsx)("span",{className:l.default.stepNumber,children:"3"}),"Map CSV Columns to Template Fields"]})}),(0,a.jsx)(o,{headers:e.headers,sampleRows:e.sampleRows,template:c,columnMapping:p,onMappingUpdate:e=>{h(e)},disabled:"rendering"===f.status})]}),e.file&&c&&(0,a.jsxs)("section",{className:l.default.actions,children:[(0,a.jsx)("button",{onClick:x,className:l.default.buttonSecondary,disabled:"rendering"===f.status,children:"Generate Preview (3 rows)"}),(0,a.jsx)("button",{onClick:j,className:l.default.buttonPrimary,disabled:"rendering"===f.status,children:"rendering"===f.status?"Rendering...":"Start Batch Render"}),(0,a.jsx)("button",{onClick:()=>{r({file:null,headers:[],sampleRows:[],error:null}),h({}),b({jobId:null,status:"idle",progress:0,totalAssets:0,completedAssets:0,failedAssets:0,error:null})},className:l.default.buttonOutline,disabled:"rendering"===f.status,children:"Reset"})]}),"idle"!==f.status&&(0,a.jsx)("section",{className:l.default.section,children:(0,a.jsx)(u,{job:f})}),"previewing"===f.status&&(0,a.jsxs)("section",{className:l.default.section,children:[(0,a.jsx)("h2",{className:l.default.sectionTitle,children:"Preview"}),(0,a.jsx)(n,{jobId:f.jobId})]})]})}e.s(["default",()=>_],44634)}]);