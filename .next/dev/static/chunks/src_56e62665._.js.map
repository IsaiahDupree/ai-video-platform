{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/isaiahdupree/Documents/Software/ai-video-platform/src/components/MetaPixel.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { usePathname, useSearchParams } from 'next/navigation';\nimport Script from 'next/script';\n\ndeclare global {\n  interface Window {\n    fbq: any;\n    _fbq: any;\n  }\n}\n\ninterface MetaPixelProps {\n  pixelId: string;\n}\n\n/**\n * Meta Pixel component for Facebook/Instagram conversion tracking\n *\n * Loads the Meta Pixel base code on all pages and provides\n * tracking functionality through the window.fbq function.\n *\n * Features:\n * - Tracks PageView on initial page load\n * - Tracks PageView on client-side navigation (route changes)\n * - Initializes window.fbq for custom event tracking\n *\n * @param pixelId - Meta Pixel ID from Facebook Ads Manager\n */\nexport function MetaPixel({ pixelId }: MetaPixelProps) {\n  const pathname = usePathname();\n  const searchParams = useSearchParams();\n\n  // Initialize Meta Pixel on mount\n  useEffect(() => {\n    // Initialize fbq function if not already present\n    if (typeof window !== 'undefined' && !window.fbq) {\n      const fbq = function() {\n        // @ts-ignore\n        fbq.callMethod\n          ? // @ts-ignore\n            fbq.callMethod.apply(fbq, arguments)\n          : // @ts-ignore\n            fbq.queue.push(arguments);\n      };\n      if (!window.fbq) window.fbq = fbq;\n      // @ts-ignore\n      window.fbq.push = fbq;\n      // @ts-ignore\n      window.fbq.loaded = true;\n      // @ts-ignore\n      window.fbq.version = '2.0';\n      // @ts-ignore\n      window.fbq.queue = [];\n      window._fbq = window.fbq;\n    }\n\n    // Initialize pixel with ID\n    if (window.fbq) {\n      window.fbq('init', pixelId);\n    }\n  }, [pixelId]);\n\n  // Track PageView on pathname or search params change\n  useEffect(() => {\n    if (window.fbq && pixelId && pixelId !== 'your_meta_pixel_id_here') {\n      // Build full URL for tracking\n      const url = pathname + (searchParams?.toString() ? `?${searchParams.toString()}` : '');\n\n      // Track PageView with current URL\n      window.fbq('track', 'PageView');\n\n      if (process.env.NODE_ENV === 'development') {\n        console.log('Meta Pixel PageView tracked:', url);\n      }\n    }\n  }, [pathname, searchParams, pixelId]);\n\n  if (!pixelId || pixelId === 'your_meta_pixel_id_here') {\n    // Don't load pixel if not configured\n    console.warn('Meta Pixel ID not configured');\n    return null;\n  }\n\n  return (\n    <>\n      {/* Meta Pixel Code */}\n      <Script\n        id=\"meta-pixel\"\n        strategy=\"afterInteractive\"\n        dangerouslySetInnerHTML={{\n          __html: `\n            !function(f,b,e,v,n,t,s)\n            {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n            n.callMethod.apply(n,arguments):n.queue.push(arguments)};\n            if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n            n.queue=[];t=b.createElement(e);t.async=!0;\n            t.src=v;s=b.getElementsByTagName(e)[0];\n            s.parentNode.insertBefore(t,s)}(window, document,'script',\n            'https://connect.facebook.net/en_US/fbevents.js');\n            fbq('init', '${pixelId}');\n          `,\n        }}\n      />\n      {/* Meta Pixel NoScript fallback */}\n      <noscript>\n        <img\n          height=\"1\"\n          width=\"1\"\n          style={{ display: 'none' }}\n          src={`https://www.facebook.com/tr?id=${pixelId}&ev=PageView&noscript=1`}\n          alt=\"\"\n        />\n      </noscript>\n    </>\n  );\n}\n\n/**\n * Track a custom Meta Pixel event\n *\n * @param eventName - Name of the event (e.g., 'ViewContent', 'Lead', 'Purchase')\n * @param parameters - Event parameters (optional)\n * @param eventId - Unique event ID for deduplication with CAPI (optional)\n */\nexport function trackMetaEvent(\n  eventName: string,\n  parameters?: Record<string, any>,\n  eventId?: string\n) {\n  if (typeof window !== 'undefined' && window.fbq) {\n    // If eventId is provided, use it for deduplication\n    if (eventId) {\n      window.fbq('track', eventName, parameters, { eventID: eventId });\n    } else {\n      window.fbq('track', eventName, parameters);\n    }\n  } else {\n    console.warn('Meta Pixel not loaded, cannot track event:', eventName);\n  }\n}\n\n/**\n * Track a custom Meta Pixel event (non-standard events)\n *\n * @param eventName - Name of the custom event\n * @param parameters - Event parameters (optional)\n * @param eventId - Unique event ID for deduplication with CAPI (optional)\n */\nexport function trackMetaCustomEvent(\n  eventName: string,\n  parameters?: Record<string, any>,\n  eventId?: string\n) {\n  if (typeof window !== 'undefined' && window.fbq) {\n    // If eventId is provided, use it for deduplication\n    if (eventId) {\n      window.fbq('trackCustom', eventName, parameters, { eventID: eventId });\n    } else {\n      window.fbq('trackCustom', eventName, parameters);\n    }\n  } else {\n    console.warn('Meta Pixel not loaded, cannot track custom event:', eventName);\n  }\n}\n\n/**\n * Consent Management - Grant consent for Meta Pixel tracking\n */\nexport function grantMetaConsent() {\n  if (typeof window !== 'undefined' && window.fbq) {\n    window.fbq('consent', 'grant');\n  }\n}\n\n/**\n * Consent Management - Revoke consent for Meta Pixel tracking\n */\nexport function revokeMetaConsent() {\n  if (typeof window !== 'undefined' && window.fbq) {\n    window.fbq('consent', 'revoke');\n  }\n}\n\n/**\n * Generate a unique event ID for deduplication\n * This ID should be used for both Pixel (client-side) and CAPI (server-side)\n * to ensure Meta can deduplicate the same event sent from both sources.\n *\n * @returns Unique event ID\n */\nexport function generateMetaEventId(): string {\n  const timestamp = Date.now();\n  const random = Math.random().toString(36).substring(2, 9);\n  return `${timestamp}-${random}`;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 190, "column": 0}, "map": {"version":3,"sources":["file:///Users/isaiahdupree/Documents/Software/ai-video-platform/src/services/metaEvents.ts"],"sourcesContent":["/**\n * Meta Standard Events Mapping Service\n *\n * Maps application events to Meta (Facebook) standard events for conversion tracking.\n * This enables proper attribution, audience building, and ad optimization in Meta Ads Manager.\n *\n * Meta Standard Events Documentation:\n * https://developers.facebook.com/docs/meta-pixel/reference\n */\n\nimport { trackMetaEvent, trackMetaCustomEvent, generateMetaEventId } from '@/components/MetaPixel';\nimport { TrackingEvent, EventProperties } from '@/types/tracking';\n\n/**\n * Meta Standard Events\n *\n * These are predefined events that Meta understands and optimizes for:\n * - Lead: User submits lead form (email, signup, etc)\n * - CompleteRegistration: User completes registration\n * - ViewContent: User views content/product\n * - AddToCart: User adds item to cart\n * - InitiateCheckout: User begins checkout process\n * - AddPaymentInfo: User adds payment information\n * - Purchase: User completes purchase\n * - Subscribe: User subscribes to service\n * - StartTrial: User starts trial\n * - Search: User performs search\n */\n\n/**\n * Event mapping configuration\n * Maps internal TrackingEvent types to Meta Standard Events\n */\nconst EVENT_MAPPING: Record<TrackingEvent, {\n  metaEvent: string;\n  isStandard: boolean;\n  getValue?: (properties?: EventProperties) => number;\n}> = {\n  // Acquisition Events\n  'landing_view': {\n    metaEvent: 'ViewContent',\n    isStandard: true,\n    getValue: () => 0,\n  },\n  'signup_started': {\n    metaEvent: 'Lead',\n    isStandard: true,\n    getValue: () => 5, // Estimated value of a lead\n  },\n  'signup_completed': {\n    metaEvent: 'CompleteRegistration',\n    isStandard: true,\n    getValue: () => 10, // Estimated value of a registration\n  },\n\n  // Activation Events\n  'first_video_created': {\n    metaEvent: 'ViewContent',\n    isStandard: true,\n    getValue: () => 15,\n  },\n  'first_render_completed': {\n    metaEvent: 'CompleteRegistration', // Maps to registration because it's an activation milestone\n    isStandard: true,\n    getValue: () => 20,\n  },\n\n  // Core Value Events\n  'video_rendered': {\n    metaEvent: 'Purchase', // Treat renders as micro-conversions\n    isStandard: true,\n    getValue: (props) => {\n      // If we have render count, calculate value\n      const renderCount = props?.renderCount as number || 1;\n      return renderCount * 2; // $2 per render\n    },\n  },\n  'batch_completed': {\n    metaEvent: 'Purchase',\n    isStandard: true,\n    getValue: (props) => {\n      const batchSize = props?.batchSize as number || 10;\n      return batchSize * 2; // $2 per render\n    },\n  },\n  'export_downloaded': {\n    metaEvent: 'Purchase',\n    isStandard: true,\n    getValue: () => 5,\n  },\n\n  // Monetization Events\n  'checkout_started': {\n    metaEvent: 'InitiateCheckout',\n    isStandard: true,\n    getValue: (props) => props?.price as number || 0,\n  },\n  'purchase_completed': {\n    metaEvent: 'Purchase',\n    isStandard: true,\n    getValue: (props) => props?.price as number || 0,\n  },\n\n  // Retention Events (Custom)\n  'return_visit': {\n    metaEvent: 'ReturnVisit',\n    isStandard: false,\n    getValue: () => 5,\n  },\n  'feature_discovery': {\n    metaEvent: 'FeatureDiscovery',\n    isStandard: false,\n    getValue: () => 3,\n  },\n\n  // Feature Usage Events (Custom)\n  'template_used': {\n    metaEvent: 'TemplateUsed',\n    isStandard: false,\n    getValue: () => 2,\n  },\n  'voice_cloned': {\n    metaEvent: 'VoiceCloned',\n    isStandard: false,\n    getValue: () => 10,\n  },\n  'ad_generated': {\n    metaEvent: 'AdGenerated',\n    isStandard: false,\n    getValue: () => 5,\n  },\n\n  // Error & Performance Events (Custom)\n  'render_failed': {\n    metaEvent: 'RenderFailed',\n    isStandard: false,\n  },\n  'api_error': {\n    metaEvent: 'ApiError',\n    isStandard: false,\n  },\n  'slow_render': {\n    metaEvent: 'SlowRender',\n    isStandard: false,\n  },\n};\n\n/**\n * Track an application event with Meta Pixel\n *\n * Automatically maps internal events to Meta Standard Events\n * and sends them to Facebook for conversion tracking.\n *\n * This function generates a unique event ID for deduplication with CAPI.\n * If the same event is sent from both the browser (Pixel) and server (CAPI),\n * Meta will deduplicate them using the matching event ID.\n *\n * @param event - Internal event name\n * @param properties - Event properties\n *\n * @example\n * trackMetaAppEvent('signup_completed', {\n *   method: 'email',\n *   timestamp: new Date().toISOString(),\n * });\n */\nexport function trackMetaAppEvent(\n  event: TrackingEvent,\n  properties?: EventProperties\n): void {\n  const mapping = EVENT_MAPPING[event];\n\n  if (!mapping) {\n    console.warn(`No Meta event mapping found for: ${event}`);\n    return;\n  }\n\n  const { metaEvent, isStandard, getValue } = mapping;\n\n  // Generate unique event ID for deduplication with CAPI\n  // If properties already has an eventId, use it (for server-side calls)\n  // Otherwise generate a new one\n  const eventId = (properties?.eventId as string) || generateMetaEventId();\n\n  // Build Meta event parameters\n  const metaParams: Record<string, any> = {\n    // Include original event name for debugging\n    original_event: event,\n\n    // Include timestamp\n    timestamp: properties?.timestamp || new Date().toISOString(),\n\n    // Include event ID for deduplication\n    event_id: eventId,\n  };\n\n  // Add value if available\n  if (getValue) {\n    const value = getValue(properties);\n    if (value > 0) {\n      metaParams.value = value;\n      metaParams.currency = 'USD';\n    }\n  }\n\n  // Add event-specific parameters based on event type\n  switch (event) {\n    case 'landing_view':\n      metaParams.content_type = 'landing_page';\n      metaParams.content_name = properties?.page as string || 'unknown';\n      break;\n\n    case 'signup_started':\n    case 'signup_completed':\n      metaParams.content_category = 'signup';\n      metaParams.content_name = 'user_registration';\n      break;\n\n    case 'first_video_created':\n    case 'first_render_completed':\n      metaParams.content_category = 'activation';\n      metaParams.content_name = 'first_render';\n      break;\n\n    case 'video_rendered':\n      metaParams.content_type = 'video';\n      metaParams.content_ids = properties?.videoId ? [properties.videoId] : [];\n      metaParams.num_items = properties?.renderCount || 1;\n      break;\n\n    case 'batch_completed':\n      metaParams.content_type = 'batch';\n      metaParams.num_items = properties?.batchSize || 0;\n      break;\n\n    case 'export_downloaded':\n      metaParams.content_type = 'export';\n      metaParams.content_name = properties?.format as string || 'unknown';\n      break;\n\n    case 'checkout_started':\n      metaParams.content_ids = [properties?.planId as string];\n      metaParams.content_name = properties?.planName as string;\n      metaParams.content_type = 'product';\n      metaParams.value = properties?.price as number || 0;\n      metaParams.currency = 'USD';\n      break;\n\n    case 'purchase_completed':\n      metaParams.content_ids = [properties?.planId as string];\n      metaParams.content_name = properties?.planName as string;\n      metaParams.content_type = 'product';\n      metaParams.value = properties?.price as number || 0;\n      metaParams.currency = 'USD';\n      // Add transaction ID for deduplication\n      if (properties?.transactionId) {\n        metaParams.transaction_id = properties.transactionId;\n      }\n      break;\n\n    case 'template_used':\n      metaParams.content_ids = [properties?.templateId as string];\n      metaParams.content_name = properties?.templateName as string;\n      break;\n\n    case 'voice_cloned':\n      metaParams.content_type = 'voice_clone';\n      metaParams.content_name = properties?.voiceId as string;\n      break;\n\n    case 'ad_generated':\n      metaParams.content_type = 'ad';\n      metaParams.content_ids = [properties?.adId as string];\n      break;\n  }\n\n  // Merge in any additional properties\n  const finalParams = {\n    ...metaParams,\n    ...properties,\n  };\n\n  // Track with Meta Pixel (with event ID for deduplication)\n  if (isStandard) {\n    trackMetaEvent(metaEvent, finalParams, eventId);\n\n    if (process.env.NODE_ENV === 'development') {\n      console.log(`[Meta Standard Event] ${metaEvent}:`, {\n        ...finalParams,\n        dedup_event_id: eventId,\n      });\n    }\n  } else {\n    trackMetaCustomEvent(metaEvent, finalParams, eventId);\n\n    if (process.env.NODE_ENV === 'development') {\n      console.log(`[Meta Custom Event] ${metaEvent}:`, {\n        ...finalParams,\n        dedup_event_id: eventId,\n      });\n    }\n  }\n}\n\n/**\n * Get the Meta event mapping for an internal event\n * Useful for debugging and testing\n */\nexport function getMetaEventMapping(event: TrackingEvent): {\n  metaEvent: string;\n  isStandard: boolean;\n} | null {\n  const mapping = EVENT_MAPPING[event];\n  if (!mapping) return null;\n\n  return {\n    metaEvent: mapping.metaEvent,\n    isStandard: mapping.isStandard,\n  };\n}\n\n/**\n * Get all event mappings\n * Useful for documentation and debugging\n */\nexport function getAllEventMappings(): Record<TrackingEvent, {\n  metaEvent: string;\n  isStandard: boolean;\n}> {\n  const result = {} as Record<TrackingEvent, {\n    metaEvent: string;\n    isStandard: boolean;\n  }>;\n\n  for (const [event, mapping] of Object.entries(EVENT_MAPPING)) {\n    result[event as TrackingEvent] = {\n      metaEvent: mapping.metaEvent,\n      isStandard: mapping.isStandard,\n    };\n  }\n\n  return result;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 476, "column": 0}, "map": {"version":3,"sources":["file:///Users/isaiahdupree/Documents/Software/ai-video-platform/src/services/tracking.ts"],"sourcesContent":["import posthog from 'posthog-js';\nimport {\n  TrackingConfig,\n  UserProperties,\n  EventProperties,\n  TrackingEvent,\n  ITrackingService,\n} from '../types/tracking';\nimport { trackMetaAppEvent } from './metaEvents';\n\nclass ClientTrackingService implements ITrackingService {\n  private initialized = false;\n  private enabled = false;\n\n  constructor() {\n    if (typeof window === 'undefined') {\n      return;\n    }\n  }\n\n  initialize(config: TrackingConfig): void {\n    if (this.initialized) {\n      console.warn('Tracking service already initialized');\n      return;\n    }\n\n    if (!config.apiKey) {\n      console.warn('PostHog API key not provided. Tracking disabled.');\n      this.enabled = false;\n      return;\n    }\n\n    this.enabled = config.enabled !== false;\n\n    if (!this.enabled) {\n      console.info('Tracking is disabled');\n      return;\n    }\n\n    try {\n      posthog.init(config.apiKey, {\n        api_host: config.host || 'https://us.i.posthog.com',\n        loaded: (posthog) => {\n          if (process.env.NODE_ENV === 'development') {\n            posthog.debug();\n          }\n        },\n        capture_pageview: false,\n        capture_pageleave: true,\n        autocapture: false,\n        persistence: 'localStorage+cookie',\n      });\n\n      this.initialized = true;\n      console.info('PostHog tracking initialized');\n    } catch (error) {\n      console.error('Failed to initialize PostHog:', error);\n      this.enabled = false;\n    }\n  }\n\n  identify(userId: string, properties?: UserProperties): void {\n    if (!this.isEnabled()) return;\n\n    try {\n      posthog.identify(userId, properties);\n    } catch (error) {\n      console.error('Failed to identify user:', error);\n    }\n  }\n\n  track(event: TrackingEvent, properties?: EventProperties): void {\n    if (!this.isEnabled()) {\n      console.debug('Tracking disabled, skipping event:', event);\n      return;\n    }\n\n    try {\n      // Track with PostHog\n      posthog.capture(event, properties);\n\n      // Also track with Meta Pixel (if available)\n      if (typeof window !== 'undefined') {\n        trackMetaAppEvent(event, properties);\n      }\n    } catch (error) {\n      console.error('Failed to track event:', error);\n    }\n  }\n\n  page(name?: string, properties?: EventProperties): void {\n    if (!this.isEnabled()) return;\n\n    try {\n      posthog.capture('$pageview', {\n        $current_url: window.location.href,\n        page_name: name,\n        ...properties,\n      });\n    } catch (error) {\n      console.error('Failed to track page view:', error);\n    }\n  }\n\n  reset(): void {\n    if (!this.isEnabled()) return;\n\n    try {\n      posthog.reset();\n    } catch (error) {\n      console.error('Failed to reset tracking:', error);\n    }\n  }\n\n  isEnabled(): boolean {\n    return this.initialized && this.enabled;\n  }\n}\n\nexport const tracking = new ClientTrackingService();\n"],"names":[],"mappings":";;;;AA2Cc;AA3Cd;AAQA;;;AAEA,MAAM;IACI,cAAc,MAAM;IACpB,UAAU,MAAM;IAExB,aAAc;QACZ;;IAGF;IAEA,WAAW,MAAsB,EAAQ;QACvC,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,QAAQ,IAAI,CAAC;YACb;QACF;QAEA,IAAI,CAAC,OAAO,MAAM,EAAE;YAClB,QAAQ,IAAI,CAAC;YACb,IAAI,CAAC,OAAO,GAAG;YACf;QACF;QAEA,IAAI,CAAC,OAAO,GAAG,OAAO,OAAO,KAAK;QAElC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;YACjB,QAAQ,IAAI,CAAC;YACb;QACF;QAEA,IAAI;YACF,6JAAO,CAAC,IAAI,CAAC,OAAO,MAAM,EAAE;gBAC1B,UAAU,OAAO,IAAI,IAAI;gBACzB,QAAQ,CAAC;oBACP,wCAA4C;wBAC1C,QAAQ,KAAK;oBACf;gBACF;gBACA,kBAAkB;gBAClB,mBAAmB;gBACnB,aAAa;gBACb,aAAa;YACf;YAEA,IAAI,CAAC,WAAW,GAAG;YACnB,QAAQ,IAAI,CAAC;QACf,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iCAAiC;YAC/C,IAAI,CAAC,OAAO,GAAG;QACjB;IACF;IAEA,SAAS,MAAc,EAAE,UAA2B,EAAQ;QAC1D,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI;QAEvB,IAAI;YACF,6JAAO,CAAC,QAAQ,CAAC,QAAQ;QAC3B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;QAC5C;IACF;IAEA,MAAM,KAAoB,EAAE,UAA4B,EAAQ;QAC9D,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI;YACrB,QAAQ,KAAK,CAAC,sCAAsC;YACpD;QACF;QAEA,IAAI;YACF,qBAAqB;YACrB,6JAAO,CAAC,OAAO,CAAC,OAAO;YAEvB,4CAA4C;YAC5C,wCAAmC;gBACjC,IAAA,qJAAiB,EAAC,OAAO;YAC3B;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;QAC1C;IACF;IAEA,KAAK,IAAa,EAAE,UAA4B,EAAQ;QACtD,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI;QAEvB,IAAI;YACF,6JAAO,CAAC,OAAO,CAAC,aAAa;gBAC3B,cAAc,OAAO,QAAQ,CAAC,IAAI;gBAClC,WAAW;gBACX,GAAG,UAAU;YACf;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,8BAA8B;QAC9C;IACF;IAEA,QAAc;QACZ,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI;QAEvB,IAAI;YACF,6JAAO,CAAC,KAAK;QACf,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;QAC7C;IACF;IAEA,YAAqB;QACnB,OAAO,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,OAAO;IACzC;AACF;AAEO,MAAM,WAAW,IAAI"}},
    {"offset": {"line": 583, "column": 0}, "map": {"version":3,"sources":["file:///Users/isaiahdupree/Documents/Software/ai-video-platform/src/services/retentionTracking.ts"],"sourcesContent":["/**\n * Retention Event Tracking\n *\n * Tracks user retention and feature discovery events:\n * - return_visit: When users return to the platform\n * - feature_discovery: When users discover/use features for the first time\n */\n\nimport { tracking } from './tracking';\n\nconst STORAGE_KEY_PREFIX = 'retention_tracking_';\nconst LAST_VISIT_KEY = `${STORAGE_KEY_PREFIX}last_visit`;\nconst DISCOVERED_FEATURES_KEY = `${STORAGE_KEY_PREFIX}discovered_features`;\nconst VISIT_COUNT_KEY = `${STORAGE_KEY_PREFIX}visit_count`;\nconst FIRST_VISIT_KEY = `${STORAGE_KEY_PREFIX}first_visit`;\n\n// Return visit threshold: 30 minutes (if they come back after 30 min, it's a new visit)\nconst RETURN_VISIT_THRESHOLD_MS = 30 * 60 * 1000; // 30 minutes\n\nexport type DiscoverableFeature =\n  | 'ad_editor'\n  | 'template_library'\n  | 'brand_kit'\n  | 'batch_render'\n  | 'campaign_generator'\n  | 'csv_import'\n  | 'screenshot_editor'\n  | 'device_frames'\n  | 'caption_overlay'\n  | 'screenshot_resize'\n  | 'locale_export'\n  | 'asset_library'\n  | 'custom_product_page'\n  | 'ppo_test'\n  | 'app_preview_generator'\n  | 'analytics_dashboard'\n  | 'voice_clone'\n  | 'text_to_video'\n  | 'image_generation'\n  | 'approval_workflow'\n  | 'ai_variants'\n  | 'localization'\n  | 'creative_qa';\n\ninterface RetentionData {\n  visitCount: number;\n  firstVisit: string;\n  lastVisit: string;\n  discoveredFeatures: DiscoverableFeature[];\n}\n\n/**\n * Check if browser environment (not SSR)\n */\nfunction isBrowser(): boolean {\n  return typeof window !== 'undefined' && typeof localStorage !== 'undefined';\n}\n\n/**\n * Get data from localStorage\n */\nfunction getLocalStorageItem(key: string): string | null {\n  if (!isBrowser()) return null;\n  try {\n    return localStorage.getItem(key);\n  } catch (error) {\n    console.error('Failed to read from localStorage:', error);\n    return null;\n  }\n}\n\n/**\n * Set data in localStorage\n */\nfunction setLocalStorageItem(key: string, value: string): void {\n  if (!isBrowser()) return;\n  try {\n    localStorage.setItem(key, value);\n  } catch (error) {\n    console.error('Failed to write to localStorage:', error);\n  }\n}\n\n/**\n * Get all retention data\n */\nfunction getRetentionData(): RetentionData {\n  const visitCount = parseInt(getLocalStorageItem(VISIT_COUNT_KEY) || '0', 10);\n  const firstVisit = getLocalStorageItem(FIRST_VISIT_KEY) || new Date().toISOString();\n  const lastVisit = getLocalStorageItem(LAST_VISIT_KEY) || '';\n  const discoveredFeaturesRaw = getLocalStorageItem(DISCOVERED_FEATURES_KEY) || '[]';\n\n  let discoveredFeatures: DiscoverableFeature[] = [];\n  try {\n    discoveredFeatures = JSON.parse(discoveredFeaturesRaw);\n  } catch (error) {\n    console.error('Failed to parse discovered features:', error);\n    discoveredFeatures = [];\n  }\n\n  return {\n    visitCount,\n    firstVisit,\n    lastVisit,\n    discoveredFeatures,\n  };\n}\n\n/**\n * Calculate days since first visit\n */\nfunction getDaysSinceFirstVisit(firstVisit: string): number {\n  if (!firstVisit) return 0;\n  const firstVisitDate = new Date(firstVisit);\n  const now = new Date();\n  const diffMs = now.getTime() - firstVisitDate.getTime();\n  return Math.floor(diffMs / (1000 * 60 * 60 * 24));\n}\n\n/**\n * Calculate hours since last visit\n */\nfunction getHoursSinceLastVisit(lastVisit: string): number | null {\n  if (!lastVisit) return null;\n  const lastVisitDate = new Date(lastVisit);\n  const now = new Date();\n  const diffMs = now.getTime() - lastVisitDate.getTime();\n  return Math.floor(diffMs / (1000 * 60 * 60));\n}\n\n/**\n * Track return visit\n * Call this when the user loads the app\n */\nexport function trackReturnVisit(): void {\n  if (!isBrowser()) return;\n\n  const now = new Date();\n  const nowISO = now.toISOString();\n\n  const data = getRetentionData();\n  const lastVisitDate = data.lastVisit ? new Date(data.lastVisit) : null;\n\n  // Calculate if this is a new visit (based on threshold)\n  const isNewVisit = !lastVisitDate ||\n    (now.getTime() - lastVisitDate.getTime()) > RETURN_VISIT_THRESHOLD_MS;\n\n  // If first visit, just record it\n  if (data.visitCount === 0) {\n    setLocalStorageItem(FIRST_VISIT_KEY, nowISO);\n    setLocalStorageItem(LAST_VISIT_KEY, nowISO);\n    setLocalStorageItem(VISIT_COUNT_KEY, '1');\n\n    // Don't track return_visit on first visit\n    return;\n  }\n\n  // If new visit (after threshold), track it\n  if (isNewVisit) {\n    const newVisitCount = data.visitCount + 1;\n    const daysSinceFirstVisit = getDaysSinceFirstVisit(data.firstVisit);\n    const hoursSinceLastVisit = getHoursSinceLastVisit(data.lastVisit);\n\n    // Track the return visit event\n    tracking.track('return_visit', {\n      visitCount: newVisitCount,\n      daysSinceFirstVisit,\n      hoursSinceLastVisit,\n      firstVisit: data.firstVisit,\n      lastVisit: data.lastVisit,\n      timestamp: nowISO,\n    });\n\n    // Update storage\n    setLocalStorageItem(LAST_VISIT_KEY, nowISO);\n    setLocalStorageItem(VISIT_COUNT_KEY, newVisitCount.toString());\n  }\n\n  // Always update last visit timestamp (even if not a \"new visit\")\n  setLocalStorageItem(LAST_VISIT_KEY, nowISO);\n}\n\n/**\n * Track feature discovery\n * Call this when a user uses a feature for the first time\n */\nexport function trackFeatureDiscovery(feature: DiscoverableFeature): void {\n  if (!isBrowser()) return;\n\n  const data = getRetentionData();\n\n  // Check if already discovered\n  if (data.discoveredFeatures.includes(feature)) {\n    return; // Already tracked\n  }\n\n  // Add to discovered features\n  const updatedFeatures = [...data.discoveredFeatures, feature];\n  setLocalStorageItem(DISCOVERED_FEATURES_KEY, JSON.stringify(updatedFeatures));\n\n  const daysSinceFirstVisit = getDaysSinceFirstVisit(data.firstVisit);\n  const totalDiscoveredCount = updatedFeatures.length;\n\n  // Track the feature discovery event\n  tracking.track('feature_discovery', {\n    feature,\n    totalDiscoveredCount,\n    visitCount: data.visitCount,\n    daysSinceFirstVisit,\n    timestamp: new Date().toISOString(),\n  });\n}\n\n/**\n * Check if a feature has been discovered\n */\nexport function hasDiscoveredFeature(feature: DiscoverableFeature): boolean {\n  if (!isBrowser()) return false;\n  const data = getRetentionData();\n  return data.discoveredFeatures.includes(feature);\n}\n\n/**\n * Get retention statistics\n */\nexport function getRetentionStats(): RetentionData & {\n  daysSinceFirstVisit: number;\n  hoursSinceLastVisit: number | null;\n} {\n  const data = getRetentionData();\n  return {\n    ...data,\n    daysSinceFirstVisit: getDaysSinceFirstVisit(data.firstVisit),\n    hoursSinceLastVisit: getHoursSinceLastVisit(data.lastVisit),\n  };\n}\n\n/**\n * Reset retention tracking (for testing)\n */\nexport function resetRetentionTracking(): void {\n  if (!isBrowser()) return;\n  try {\n    localStorage.removeItem(LAST_VISIT_KEY);\n    localStorage.removeItem(DISCOVERED_FEATURES_KEY);\n    localStorage.removeItem(VISIT_COUNT_KEY);\n    localStorage.removeItem(FIRST_VISIT_KEY);\n  } catch (error) {\n    console.error('Failed to reset retention tracking:', error);\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 767, "column": 0}, "map": {"version":3,"sources":["file:///Users/isaiahdupree/Documents/Software/ai-video-platform/src/components/TrackingProvider.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, createContext, useContext, ReactNode } from 'react';\nimport { tracking } from '../services/tracking';\nimport { ITrackingService } from '../types/tracking';\nimport { trackReturnVisit } from '../services/retentionTracking';\n\nconst TrackingContext = createContext<ITrackingService>(tracking);\n\nexport const useTracking = () => {\n  return useContext(TrackingContext);\n};\n\ninterface TrackingProviderProps {\n  children: ReactNode;\n  apiKey?: string;\n  host?: string;\n  enabled?: boolean;\n}\n\nexport function TrackingProvider({\n  children,\n  apiKey,\n  host,\n  enabled = true,\n}: TrackingProviderProps) {\n  useEffect(() => {\n    const key = apiKey || process.env.NEXT_PUBLIC_POSTHOG_KEY;\n    const hostUrl = host || process.env.NEXT_PUBLIC_POSTHOG_HOST;\n\n    if (key) {\n      tracking.initialize({\n        apiKey: key,\n        host: hostUrl,\n        enabled,\n      });\n    }\n\n    // Track return visit after a short delay (to ensure tracking is initialized)\n    const timer = setTimeout(() => {\n      trackReturnVisit();\n    }, 500);\n\n    return () => clearTimeout(timer);\n  }, [apiKey, host, enabled]);\n\n  return (\n    <TrackingContext.Provider value={tracking}>\n      {children}\n    </TrackingContext.Provider>\n  );\n}\n"],"names":[],"mappings":";;;;;;AA2B0B;;AAzB1B;AACA;AAEA;;;AALA;;;;AAOA,MAAM,gCAAkB,IAAA,8KAAa,EAAmB,0IAAQ;AAEzD,MAAM,cAAc;;IACzB,OAAO,IAAA,2KAAU,EAAC;AACpB;GAFa;AAWN,SAAS,iBAAiB,EAC/B,QAAQ,EACR,MAAM,EACN,IAAI,EACJ,UAAU,IAAI,EACQ;;IACtB,IAAA,0KAAS;sCAAC;YACR,MAAM,MAAM,UAAU,2KAAO,CAAC,GAAG,CAAC,uBAAuB;YACzD,MAAM,UAAU,QAAQ,2KAAO,CAAC,GAAG,CAAC,wBAAwB;YAE5D,IAAI,KAAK;gBACP,0IAAQ,CAAC,UAAU,CAAC;oBAClB,QAAQ;oBACR,MAAM;oBACN;gBACF;YACF;YAEA,6EAA6E;YAC7E,MAAM,QAAQ;oDAAW;oBACvB,IAAA,2JAAgB;gBAClB;mDAAG;YAEH;8CAAO,IAAM,aAAa;;QAC5B;qCAAG;QAAC;QAAQ;QAAM;KAAQ;IAE1B,qBACE,6LAAC,gBAAgB,QAAQ;QAAC,OAAO,0IAAQ;kBACtC;;;;;;AAGP;IA/BgB;KAAA"}}]
}