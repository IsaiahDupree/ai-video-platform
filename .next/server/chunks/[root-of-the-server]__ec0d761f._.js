module.exports=[18622,(e,r,t)=>{r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,r,t)=>{r.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},54799,(e,r,t)=>{r.exports=e.x("crypto",()=>require("crypto"))},45722,e=>{"use strict";var r=e.i(24389);let t=process.env.SUPABASE_URL||"",s=process.env.SUPABASE_ANON_KEY||"",n=process.env.SUPABASE_SERVICE_KEY||"";t||console.warn("SUPABASE_URL not configured"),s||n||console.warn("SUPABASE_ANON_KEY or SUPABASE_SERVICE_KEY not configured"),(0,r.createClient)(t,s,{auth:{persistSession:!1}});let i=(0,r.createClient)(t,n,{auth:{persistSession:!1,autoRefreshToken:!1}});async function o(e){let{data:r,error:t}=await i.rpc("find_or_create_person",{p_identity_type:e.identity_type,p_identity_value:e.identity_value,p_source:e.source||null,p_email:e.email||null,p_user_id:e.user_id||null,p_first_name:e.first_name||null,p_last_name:e.last_name||null});if(t)throw Error(`Error in find_or_create_person: ${t.message}`);let{data:s,error:n}=await i.from("person").select("*").eq("id",r).single();if(n)throw Error(`Error fetching person: ${n.message}`);return s}async function a(e){let{data:r,error:t}=await i.from("event").insert(e).select().single();if(t){if("23505"===t.code){console.log(`Event deduplicated: ${e.event_id} from ${e.event_source}`);let{data:r}=await i.from("event").select("*").eq("event_id",e.event_id).eq("event_source",e.event_source).single();return r}throw Error(`Error creating event: ${t.message}`)}return r}async function c(e){let{data:r,error:t}=await i.from("subscription").insert(e).select().single();if(t)throw Error(`Error creating subscription: ${t.message}`);return r}async function p(e,r){let{data:t,error:s}=await i.from("subscription").update(r).eq("stripe_subscription_id",e).select().single();if(s)throw Error(`Error updating subscription: ${s.message}`);return t}async function l(e){let{data:r,error:t}=await i.from("subscription").select("*").eq("id",e).single();if(t&&"PGRST116"===t.code)return null;if(t)throw Error(`Error fetching subscription: ${t.message}`);return r}e.s(["createEvent",()=>a,"createSubscription",()=>c,"findOrCreatePerson",()=>o,"getSubscription",()=>l,"updateSubscription",()=>p],45722)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ec0d761f._.js.map